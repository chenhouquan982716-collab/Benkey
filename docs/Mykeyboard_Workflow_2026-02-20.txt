# Mykeyboard å·¥ä½œæµç¨‹æ±‡æ€»ï¼ˆ2026-02-20ï¼‰

## æ¦‚è§ˆ
- ç›®æ ‡ï¼šåœ¨ Benkey å·¥ç¨‹æ–°å¢ Custom Keyboard Extensionï¼ˆMykeyboardï¼‰ï¼Œå¹¶åœ¨é”®ç›˜ç•Œé¢æ˜¾ç¤ºâ€œæˆ‘çš„ç¬¬ä¸€ä¸ªé”®ç›˜â€æŒ‰é’®ã€‚
- äº§å‡ºï¼šæ‰©å±• Targetã€çº¯ä»£ç  UIKit é”®ç›˜ç•Œé¢ã€å¯åœ¨æ¨¡æ‹Ÿå™¨å¯ç”¨å¹¶éªŒè¯ã€‚

## ç¯å¢ƒå‡†å¤‡
- ç¡®è®¤ Xcode 15.4 å¹¶æ¸…ç† Betaï¼š
  - xcode-select æŒ‡å‘ /Applications/Xcode.app/Contents/Developer
  - åˆ é™¤ /Applications/Xcode-beta.appï¼ˆå¦‚å­˜åœ¨ï¼‰
- å®‰è£…è¿è¡Œæ—¶ä¸æ¨¡æ‹Ÿå™¨ï¼š
  - Xcode â†’ Settings â†’ Platforms â†’ å®‰è£… iOS 17.5
  - åˆ›å»ºå¹¶å¯åŠ¨ iPhone 15 æ¨¡æ‹Ÿå™¨ï¼ˆUDID ç¤ºä¾‹ï¼š991F3426-92DD-4E5A-AB71-9012695E6F0Dï¼‰
- è½¯é”®ç›˜æ˜¾ç¤ºï¼š
  - æ¨¡æ‹Ÿå™¨èœå•ï¼ˆä¸­æ–‡ï¼‰ï¼šè®¾å¤‡ â†’ é”®ç›˜ â†’ å–æ¶ˆâ€œè¿æ¥ç¡¬ä»¶é”®ç›˜â€ï¼Œæˆ–ä½¿ç”¨å¿«æ·é”® Command+Kã€‚

## å·¥ç¨‹åˆ›å»ºä¸ç‰ˆæœ¬æ§åˆ¶
- åˆ›å»ºå®¿ä¸» Appï¼šFile â†’ New â†’ Projectâ€¦ â†’ iOS Appï¼ˆSwiftUIï¼‰
- è§£å†³ Git ä»“åº“åˆ›å»ºå¤±è´¥ï¼š
  - ç»ˆç«¯é…ç½®ï¼šgit config --global user.name / user.email
  - åˆå§‹åŒ–å¹¶é¦–ä¸ªæäº¤ï¼šgit initã€git add -Aã€git commit -m "Initial commit"
- å¯é€‰ï¼šé€šè¿‡ç½‘é¡µåˆ›å»º GitHub ä»“åº“ï¼Œä½¿ç”¨ Add file â†’ Upload files ä¸Šä¼ å·¥ç¨‹ï¼ˆé¿å…ä¸Šä¼  xcuserdataã€DerivedData ç­‰ï¼‰ã€‚

## æ–°å¢æ‰©å±• Target
- å…¥å£ä¸€ï¼šFile â†’ New â†’ Targetâ€¦
- å…¥å£äºŒï¼šé€‰ä¸­è“è‰²å·¥ç¨‹å›¾æ ‡ â†’ â€œTARGETSâ€å·¦ä¸‹è§’â€œ+â€
- æ¨¡æ¿ï¼šiOS â†’ Application Extension â†’ Custom Keyboard Extension
- åˆ›å»ºåï¼š
  - å‹¾é€‰ Embed in Application ä¸º Benkey
  - æ¿€æ´»æ‰©å±• Schemeï¼Œå¹¶åœ¨ Product â†’ Scheme â†’ Edit Scheme â†’ Run â†’ Executable é€‰æ‹© Benkey.app

## æ‰©å±•å®ç°ï¼ˆçº¯ä»£ç  UIKitï¼‰
- Info.plistï¼ˆMykeyboard â†’ Infoï¼‰å…³é”®é…ç½®ï¼š
  - NSExtensionPointIdentifier = com.apple.keyboard-service
  - NSExtensionPrincipalClass = $(PRODUCT_MODULE_NAME).KeyboardViewController
  - ä¸ä½¿ç”¨ storyboardï¼ˆç§»é™¤æˆ–æ¸…ç©º NSExtensionMainStoryboardï¼‰
- é”®ç›˜ç•Œé¢ä»£ç ï¼š[KeyboardViewController.swift](file:///Users/houquanchen/Documents/trae_projects/Benkey/Mykeyboard/KeyboardViewController.swift)

```swift
import UIKit

final class KeyboardViewController: UIInputViewController {
    private lazy var titleButton: UIButton = {
        let b = UIButton(type: .system)
        b.setTitle("æˆ‘çš„ç¬¬ä¸€ä¸ªé”®ç›˜", for: .normal)
        b.titleLabel?.font = .systemFont(ofSize: 18, weight: .medium)
        b.translatesAutoresizingMaskIntoConstraints = false
        b.addTarget(self, action: #selector(onTitleTap), for: .touchUpInside)
        return b
    }()

    private lazy var nextKeyboardButton: UIButton = {
        let b = UIButton(type: .system)
        b.setTitle("ğŸŒ", for: .normal)
        b.translatesAutoresizingMaskIntoConstraints = false
        b.addTarget(self, action: #selector(handleInputModeList(from:with:)), for: .allTouchEvents)
        return b
    }()

    override func viewDidLoad() {
        super.viewDidLoad()
        view.backgroundColor = .systemGray6

        view.addSubview(titleButton)
        view.addSubview(nextKeyboardButton)

        let g = view.safeAreaLayoutGuide
        NSLayoutConstraint.activate([
            titleButton.centerXAnchor.constraint(equalTo: g.centerXAnchor),
            titleButton.centerYAnchor.constraint(equalTo: g.centerYAnchor),

            nextKeyboardButton.leadingAnchor.constraint(equalTo: g.leadingAnchor, constant: 12),
            nextKeyboardButton.bottomAnchor.constraint(equalTo: g.bottomAnchor, constant: -8)
        ])
    }

    override func viewWillLayoutSubviews() {
        nextKeyboardButton.isHidden = !needsInputModeSwitchKey
        super.viewWillLayoutSubviews()
    }

    @objc private func onTitleTap() {
        textDocumentProxy.insertText(" ")
    }
}
```

## å¯ç”¨ä¸éªŒè¯
- åœ¨æ¨¡æ‹Ÿå™¨ï¼ˆä¸­æ–‡ï¼‰è·¯å¾„ï¼šè®¾ç½® â†’ é€šç”¨ â†’ é”®ç›˜ â†’ é”®ç›˜ â†’ æ·»åŠ æ–°é”®ç›˜â€¦ â†’ é€‰æ‹©â€œMykeyboard â€” Benkeyâ€
- æ‰“å¼€ä»»æ„è¾“å…¥æ¡†ï¼Œé•¿æŒ‰åœ°çƒä»ªé€‰æ‹©â€œMykeyboardâ€ï¼Œå¯è§æŒ‰é’®â€œæˆ‘çš„ç¬¬ä¸€ä¸ªé”®ç›˜â€ï¼Œç‚¹å‡»ä¼šæ’å…¥ç©ºæ ¼ã€‚

## å»ºè®®ä¸æœ€ä½³å®è·µ
- ç‰ˆæœ¬æ§åˆ¶ï¼š
  - ä½¿ç”¨ Xcode/Swift çš„ .gitignoreï¼Œé¿å…æäº¤ xcuserdataã€DerivedDataã€build ç­‰ã€‚
  - å…±äº« Schemeï¼šManage Schemesâ€¦ å‹¾é€‰ Sharedï¼Œä»¥ä¾¿å›¢é˜Ÿå¯è¿è¡Œæ‰©å±•ã€‚
  - ä¼˜å…ˆä½¿ç”¨ SSH å¯†é’¥æ¨é€åˆ° GitHubï¼›åœ¨ GitHub è´¦æˆ·è®¾ç½®æ·»åŠ å…¬é’¥åä½¿ç”¨ git@github.com:<user>/<repo>.gitã€‚
- å·¥ç¨‹è®¾ç½®ï¼š
  - Mykeyboard çš„ iOS Deployment Target ä¸è¦é«˜äºæ¨¡æ‹Ÿå™¨ç‰ˆæœ¬ï¼ˆå»ºè®® â‰¤ 17.5ï¼‰ã€‚
  - Info.plist ä¿æŒ RequestsOpenAccess = falseï¼ˆæœ€å°æƒé™ï¼‰ï¼Œä¸è¦é‡‡é›†é”®å…¥æ•°æ®ã€‚
- æ–‡æ¡£ä¸æµ‹è¯•ï¼š
  - åœ¨ä»“åº“æ·»åŠ  READMEï¼Œå†™æ˜å¯ç”¨æ­¥éª¤ä¸å¸¸è§é—®é¢˜ï¼ˆç¡¬ä»¶é”®ç›˜è¿æ¥å¯¼è‡´è½¯é”®ç›˜éšè—ç­‰ï¼‰ã€‚
  - åç»­å¯æ·»åŠ æœ€å° UI æµ‹è¯•ï¼ŒéªŒè¯æŒ‰é’®å­˜åœ¨ä¸ç‚¹å‡»æ’å…¥è¡Œä¸ºã€‚

## åç»­è®¡åˆ’ï¼ˆå»ºè®®ï¼‰
- å¢åŠ æ›´å¤šæŒ‰é”®ä¸å¸ƒå±€ï¼Œæ”¯æŒæ–‡æœ¬è¾“å…¥ä¸åˆ é™¤ã€‚
- å¢åŠ æœ¬åœ°åŒ–æ–‡æ¡ˆä¸ä¸»é¢˜é€‚é…ï¼ˆæµ…è‰²/æ·±è‰²ï¼‰ã€‚
- è®¾è®¡é”®ç›˜é«˜åº¦ä¸å®‰å…¨åŒºé€‚é…ï¼Œå…¼å®¹æ¨ªå±ã€‚
- ç ”ç©¶ RequestsOpenAccess æ‰“å¼€åçš„èƒ½åŠ›ä¸éšç§è¾¹ç•Œã€‚

## é™„å½•
- å…³é”®æ–‡ä»¶é“¾æ¥ï¼š
  - [KeyboardViewController.swift](file:///Users/houquanchen/Documents/trae_projects/Benkey/Mykeyboard/KeyboardViewController.swift)
  - [Info.plist](file:///Users/houquanchen/Documents/trae_projects/Benkey/Mykeyboard/Info.plist)
- å¸¸ç”¨å‘½ä»¤ï¼š
  - éªŒè¯ Xcodeï¼šxcode-select -pï¼›xcodebuild -version
  - æ¨¡æ‹Ÿå™¨ï¼šxcrun simctl list runtimesï¼›xcrun simctl list devices
  - Git åˆå§‹åŒ–ä¸æäº¤ï¼š
    - git initï¼›git add -Aï¼›git commit -m "Initial commit"
  - è¿œç«¯æ¨é€ï¼ˆSSHï¼‰ï¼š
    - git remote add origin git@github.com:<user>/<repo>.git
    - git push -u origin main

